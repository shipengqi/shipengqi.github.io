<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Regex - Echo</title><meta name="Description" content=""><meta property="og:title" content="Regex" />
<meta property="og:description" content="正则表达式的三种功能：校验数据、查找文本、对文本进行切割和替换等操作。 元字符 元字符就是指那些在正则表达式中具有特殊意义的专用字符，正则就是由" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/posts/2020-05-20-regex/" /><meta property="og:image" content="http://example.org/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-02T14:28:31+08:00" />
<meta property="article:modified_time" content="2022-08-24T21:01:25+08:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://example.org/logo.png"/>

<meta name="twitter:title" content="Regex"/>
<meta name="twitter:description" content="正则表达式的三种功能：校验数据、查找文本、对文本进行切割和替换等操作。 元字符 元字符就是指那些在正则表达式中具有特殊意义的专用字符，正则就是由"/>
<meta name="application-name" content="Echo">
<meta name="apple-mobile-web-app-title" content="Echo"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://example.org/posts/2020-05-20-regex/" /><link rel="prev" href="http://example.org/posts/2020-11-03-oauth2-getting-started/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Regex",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/example.org\/posts\/2020-05-20-regex\/"
        },"genre": "posts","wordcount":  4099 ,
        "url": "http:\/\/example.org\/posts\/2020-05-20-regex\/","datePublished": "2022-05-02T14:28:31+08:00","dateModified": "2022-08-24T21:01:25+08:00","publisher": {
            "@type": "Organization",
            "name": "shipengqi"},"author": {
                "@type": "Person",
                "name": "shipengqi"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Echo"><span class="header-title-pre"><i class='fas fa-meteor fa-fw'></i></span>Echo</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="https://shipengqi.github.io/golang-learn" rel="noopener noreffer" target="_blank"> Go Learning </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/shipengqi/shipengqi.github.io" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Echo"><span class="header-title-pre"><i class='fas fa-meteor fa-fw'></i></span>Echo</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="https://shipengqi.github.io/golang-learn" title="" rel="noopener noreffer" target="_blank">Go Learning</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/shipengqi/shipengqi.github.io" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Regex</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>shipengqi</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/others/"><i class="far fa-folder fa-fw"></i>Others</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-05-02">2022-05-02</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 4099 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 9 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#元字符">元字符</a>
      <ul>
        <li><a href="#特殊单字符">特殊单字符</a></li>
        <li><a href="#空白符">空白符</a></li>
        <li><a href="#量词">量词</a></li>
        <li><a href="#范围">范围</a></li>
      </ul>
    </li>
    <li><a href="#贪婪与非贪婪模式">贪婪与非贪婪模式</a>
      <ul>
        <li><a href="#贪婪匹配greedy">贪婪匹配（Greedy）</a></li>
        <li><a href="#非贪婪匹配lazy">非贪婪匹配（Lazy）</a></li>
        <li><a href="#独占模式possessive">独占模式（Possessive）</a></li>
      </ul>
    </li>
    <li><a href="#分组与编号">分组与编号</a>
      <ul>
        <li><a href="#分组引用">分组引用</a></li>
        <li><a href="#不保存子组">不保存子组</a></li>
      </ul>
    </li>
    <li><a href="#4-中匹配模式">4 中匹配模式</a>
      <ul>
        <li><a href="#不区分大小写">不区分大小写</a></li>
        <li><a href="#点号通配模式">点号通配模式</a></li>
        <li><a href="#多行匹配模式">多行匹配模式</a></li>
        <li><a href="#注释模式">注释模式</a></li>
      </ul>
    </li>
    <li><a href="#断言">断言</a>
      <ul>
        <li><a href="#单词边界">单词边界</a></li>
        <li><a href="#行的开始或结束">行的开始或结束</a></li>
        <li><a href="#环视">环视</a></li>
      </ul>
    </li>
    <li><a href="#转义">转义</a>
      <ul>
        <li><a href="#转义字符">转义字符</a></li>
        <li><a href="#字符串转义和正则转义">字符串转义和正则转义</a></li>
        <li><a href="#元字符的转义">元字符的转义</a></li>
      </ul>
    </li>
    <li><a href="#参考链接">参考链接</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>正则表达式的三种功能：校验数据、查找文本、对文本进行切割和替换等操作。</p>
<h2 id="元字符">元字符</h2>
<p><strong>元字符就是指那些在正则表达式中具有特殊意义的专用字符</strong>，正则就是由一系列的元字符组成的。</p>
<h3 id="特殊单字符">特殊单字符</h3>
<table>
<thead>
<tr>
<th>字符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.</code></td>
<td>任意字符（除换行以外）</td>
</tr>
<tr>
<td><code>\d</code></td>
<td>任意数字</td>
</tr>
<tr>
<td><code>\D</code></td>
<td>任意非数字</td>
</tr>
<tr>
<td><code>\w</code></td>
<td>任意字母，数字，下划线</td>
</tr>
<tr>
<td><code>\W</code></td>
<td>任意非字母，数字，下划线的字符</td>
</tr>
<tr>
<td><code>\s</code></td>
<td>任意空白符</td>
</tr>
<tr>
<td><code>\S</code></td>
<td>任意非空白符</td>
</tr>
</tbody>
</table>
<h3 id="空白符">空白符</h3>
<p>空白符包括空格，换行符 <code>\n</code>， TAB 制表符 <code>\t</code> 等。不同的操作系统换行符也有区别，例如 Windows 中换行是 <code>\r\n</code>，Linux 和 MaxOS 中是 <code>\n</code>。</p>
<table>
<thead>
<tr>
<th>字符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\r</code></td>
<td>回车符</td>
</tr>
<tr>
<td><code>\n</code></td>
<td>换行符</td>
</tr>
<tr>
<td><code>\f</code></td>
<td>换页符</td>
</tr>
<tr>
<td><code>\t</code></td>
<td>制表符</td>
</tr>
<tr>
<td><code>\v</code></td>
<td>垂直制表符</td>
</tr>
<tr>
<td><code>\s</code></td>
<td>任意空白符</td>
</tr>
</tbody>
</table>
<h3 id="量词">量词</h3>
<p>量词的元字符用来表示字符出现的次数。</p>
<table>
<thead>
<tr>
<th>字符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*</code></td>
<td>0 到多次，等价于 <code>{0,}</code></td>
</tr>
<tr>
<td><code>+</code></td>
<td>1 到多次，等价于 <code>{1,}</code></td>
</tr>
<tr>
<td><code>?</code></td>
<td>0 到 1 次，等价于 <code>{0,1}</code></td>
</tr>
<tr>
<td><code>{m}</code></td>
<td>m 次</td>
</tr>
<tr>
<td><code>{m,}</code></td>
<td>至少 m 次</td>
</tr>
<tr>
<td><code>{m,n}</code></td>
<td>m 到 n 次</td>
</tr>
</tbody>
</table>
<h3 id="范围">范围</h3>
<p>使用量词去匹配手机号 <code>\d{11}</code>，但是范围比较大，会匹配到非手机号的数字，例如 11 个 0，所以需要在一定范围里找到符合要求的数字。</p>
<table>
<thead>
<tr>
<th>字符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[...]</code></td>
<td>多选一，括号中的任意单个字符</td>
</tr>
<tr>
<td><code>[a-z]</code></td>
<td>a 到 z 之间的任意单个字符</td>
</tr>
<tr>
<td><code>[^...]</code></td>
<td>取反，不能是括号中的任意单个字符</td>
</tr>
</tbody>
</table>
<p><code>|</code>：<strong>或</strong>，例如 <code>ab|bc</code> 表示 ab 或者 bc</p>
<h2 id="贪婪与非贪婪模式">贪婪与非贪婪模式</h2>
<p>使用正则 <code>a+</code> 在 aaabb 中查找，只有一个输出结果 <code>aaa</code>。但是使用 <code>a*</code> 的话会有 4 个匹配结果，分别是 <code>[&quot;aaa&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;]</code>。
为什么会匹配到空字符串？因为 <code>*</code> 表示 0 到多次，匹配 0 次就是空字符串。aaa 部分应该也有空字符串，为什么没匹配上？</p>
<h3 id="贪婪匹配greedy">贪婪匹配（Greedy）</h3>
<p><strong>在正则中，表示次数的量词默认是贪婪的，在贪婪模式下，会尝试尽可能最大长度去匹配</strong>。</p>
<p>aaabb 中使用正则 <code>a*</code> 的匹配过程：</p>
<table>
<thead>
<tr>
<th>匹配次数</th>
<th>开始</th>
<th>结束</th>
<th>说明</th>
<th>匹配结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>第 1 次</td>
<td>0</td>
<td>3</td>
<td>到第一个字母 b 发现不满足，输出 aaa</td>
<td>aaa</td>
</tr>
<tr>
<td>第 2 次</td>
<td>3</td>
<td>4</td>
<td>匹配剩下的 bb 发现不满足，输出空字符串</td>
<td>空字符串</td>
</tr>
<tr>
<td>第 3 次</td>
<td>4</td>
<td>4</td>
<td>匹配剩下的 b 发现不满足，输出空字符串</td>
<td>空字符串</td>
</tr>
<tr>
<td>第 4 次</td>
<td>5</td>
<td>5</td>
<td>匹配剩下的空字符串，输出空字符串</td>
<td>空字符串</td>
</tr>
</tbody>
</table>
<p><code>a*</code> 在匹配开头的 a 时，会尝试尽量匹配更多的 a，直到第一个字母 b 不满足要求为止，匹配上三个 a，后面每次匹配时都得到了空字符串。</p>
<p>如果想尽可能最短匹配，那就要用到非贪婪匹配模式了。</p>
<h3 id="非贪婪匹配lazy">非贪婪匹配（Lazy）</h3>
<p>非贪婪模式只需要在量词后面加上 <code>?</code>，比如 <code>a*?</code>，在用这个正则去匹配 aaabb，得到的结果就是 <code>[&quot;&quot;, &quot;a&quot;, &quot;&quot;, &quot;a&quot;, &quot;&quot;, &quot;a&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;]</code>。
这次匹配到的结果都是单个的 a，就连每个 a 左边的空字符串也匹配上了。</p>
<h3 id="独占模式possessive">独占模式（Possessive）</h3>
<p>不管是贪婪模式，还是非贪婪模式，都需要发生回溯才能完成相应的功能。但是在一些场景下，我们不需要回溯，匹配不上返回失败就好了，因此正则中还有另外一种模式，独占模式，它类似贪婪匹配，但匹配过程不会发生回溯，因此在一些场合下性能会更好。</p>
<p>什么是回溯？</p>
<p>用正则 <code>xy{1,3}z</code> 匹配文本 <code>xyyz</code>。<code>y{1,3}</code> 会尽可能长地去匹配，当匹配完 xyy 后，由于 y 要尽可能匹配最长，即三个，但字符串中后面是个 z 就会导致匹配不上，这时候正则就会向前回溯，吐出当前字符 z，接着用正则中的 z 去匹配。</p>
<p>把这个正则改成非贪婪模式 <code>xy{1,3}?z</code>，<code>y{1,3}?</code> 尽可能少地匹配。匹配上一个 y 之后，文本中的 xy 后，正则会使用 xy 后面的 y 和正则中的 z 比较，发现正则 z 和 y 不匹配，这时正则就会向前回溯，重新查看 y 匹配两个的情况，匹配上正则中的 xyy，然后再用 z 去文本 中的 z，匹配成功。</p>
<p><strong>独占模式就是在量词后面加上 <code>+</code></strong>。</p>
<p>把正则改成独占模式 <code>xy{1,3}+z</code>，<code>y{1,3}+</code> 尽可能长的匹配了两个 y，不回溯导致正则的 z 和前面的 y 匹配不上。</p>
<p>Go 不支持独占模式。</p>
<h2 id="分组与编号">分组与编号</h2>
<p><code>()</code> 在正则中可以用于分组，被括号括起来的部分“子表达式”会被保存成一个子组。分组和编号的规则，用一句话来说就是，<strong>第几个括号就是第几个分组</strong>。</p>
<p>假设时间格式是 <code>2020-05-10 20:23:05</code>，使用正则 <code>((\d{4})-(\d{2})-(\d{2})) ((\d{2}):(\d{2}):(\d{2}))</code> 来匹配。</p>
<pre tabindex="0"><code>  2020  -   05  -   10       20   :   23  :  05
((\d{4})-(\d{2})-(\d{2})) ((\d{2}):(\d{2}):(\d{2}))
12       3       4        56       7       8        // 分组编号对应着左括号的位置  
</code></pre><h3 id="分组引用">分组引用</h3>
<p>知道了分组的编号可以通过 <code>\&lt;number&gt;</code> 的方式来引用，如 <code>\2</code>。在 JavaScript 中是通过 <code>$&lt;number&gt;</code> 来引用，如 <code>$2</code>。Go 不支持。</p>
<h3 id="不保存子组">不保存子组</h3>
<p>默认情况下，在括号里面的会保存成子组，如果不需要保存子组可以在括号里面使用 <code>?:</code>，如 <code>\d{15}(?:\d{3})?</code>。</p>
<p>不保存子组可以理解成，括号只用于归组，把某个部分当成“单个元素”，不分配编号，后面不会再进行这部分的引用。可以提高正则的性能。</p>
<h2 id="4-中匹配模式">4 中匹配模式</h2>
<h3 id="不区分大小写">不区分大小写</h3>
<p>不区分大小写的模式修饰符是 <code>(?i)</code>，使用时放在整个正则前面时，就表示整个正则表达式都是不区分大小写的，如 <code>(?i)cat</code>，等价于 <code>[Cc][Aa][Tt]</code>。</p>
<h3 id="点号通配模式">点号通配模式</h3>
<p><code>.</code> 可以匹配上任何符号，除了换行。要匹配真正的“任意”符号的时候，可以使用 <code>[\s\S]</code> 或 <code>[\d\D]</code> 或 <code>[\w\W]</code> 等。也可以使用点号通配模式。有很多地方把它称作单行匹配模式。但这么说容易造成误解，毕竟它与多行匹配模式没有关系。</p>
<p>点号通配模式修饰符是 <code>(?s)</code>，如 <code>(?s).+</code></p>
<p>JavaScript 不支持，可以使用 <code>[\s\S]</code> 等方式替代。</p>
<h3 id="多行匹配模式">多行匹配模式</h3>
<p>通常情况下，<code>^</code> 匹配整个字符串的开头，<code>$</code> 匹配整个字符串的结尾。多行匹配模式改变的就是 <code>^</code> 和 <code>$</code> 的匹配行为。</p>
<p>例如 <code>^the|cat$</code> 匹配下面的文本：</p>
<pre tabindex="0"><code>the little cat
the small cat
</code></pre><p>只能匹配到第一个 <code>the</code> 和最后一个 <code>cat</code>。</p>
<p>多行模式的作用在于，使 <code>^</code> 和 <code>$</code> 能匹配上每行的开头或结尾，我们可以使用模式修饰符号 <code>(?m)</code> 来指定，如 <code>(?m)^the|cat$</code>。</p>
<p>正则中还有 <code>\A</code> 和 <code>\z</code>（Python 中是 <code>\Z</code>） 这两个元字符容易混淆，<code>\A</code> 仅匹配整个字符串的开始，<code>\z</code> 仅匹配整个字符串的结束，在多行匹配模式下，它们
的匹配行为不会改变，如果只想匹配整个字符串，而不是匹配每一行，用这个更严谨一些。</p>
<h3 id="注释模式">注释模式</h3>
<p>正则中支持添加注释，修饰符 <code>(?#)</code>，如 <code>(\w+)(?#word) \1(?#word repeat again)</code>。</p>
<h2 id="断言">断言</h2>
<p>断言是指对匹配到的文本位置有要求。 例如 <code>\d{11}</code> 能匹配上 11 位数字，但这 11 位数字可能是 18 位身份证号中的一部分。查找 tom 这个单词，但其它的单词，比如 tomorrow 中也包含了tom。</p>
<p>正则中提供了一些结构，只用于匹配位置，而不是文本内容本身，这种结构就是断言。</p>
<h3 id="单词边界">单词边界</h3>
<p>例如 <code>tom asked me if I would go fishing with him tomorrow.</code>，要把 tom 换成 jim，文本中除了 tom，tomorrow 也是以 tom 开头的。</p>
<p>单词的组成一般可以用元字符 <code>\w+</code> 来表示，只要找出单词的边界，也就是当出现了 <code>\w</code> 表示的范围以外的字符，比如引号、空格、标点、换行等这些符号，我们就可以在正则中使用 <code>\b</code> （Boundary）来表示单词的边界。</p>
<p>正则应该是 <code>\btom\b</code>。</p>
<h3 id="行的开始或结束">行的开始或结束</h3>
<p>如果要求匹配的内容要出现在一行文本开头或结尾，就可以使用 <code>^</code> 和 <code>$</code> 来进行位置界定。在多行模式下，<code>^</code> 和 <code>$</code> 符号可以匹配每一行的开头或结尾。更严谨的做法是，使用 <code>\A</code> 和 <code>\z</code> 来匹配整个文本的开头或结尾。</p>
<h3 id="环视">环视</h3>
<p>邮政编码的规则是由 6 位数字组成。现在要求提取文本中的邮政编码。根据规则，很容易就可以写出邮编的组成 <code>\d{6}</code>。但是 7 位数的前 6 位也能匹配上，12 位数可以匹配上两次。</p>
<p>也就是说，除了文本本身组成符合这 6 位数的规则外，这 6 位数左边或右边都不能是数字。正则是通过环视来解决这个问题的。</p>
<table>
<thead>
<tr>
<th>正则</th>
<th>名称</th>
<th>含义</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>(?&lt;=Y)</code></td>
<td>肯定逆序环视</td>
<td>左边是 Y</td>
<td><code>(?&lt;=\d)th</code> th 的左边是数字，可以匹配文本 9th</td>
</tr>
<tr>
<td><code>(?&lt;!Y)</code></td>
<td>否定逆序环视</td>
<td>左边不是 Y</td>
<td><code>(?&lt;!\d)th</code> th 的左边不是数字，可以匹配文本 health</td>
</tr>
<tr>
<td><code>(?=Y)</code></td>
<td>肯定顺序环视</td>
<td>右边是 Y</td>
<td><code>th(?=\d)</code> th 的右边是数字，可以匹配文本 th9</td>
</tr>
<tr>
<td><code>(?!Y)</code></td>
<td>否定顺序环视</td>
<td>右边不是 Y</td>
<td><code>th(?!\d)</code> th 的右边不是数字，可以匹配文本 the</td>
</tr>
</tbody>
</table>
<p><strong>左尖括号代表看左边，没有尖括号是看右边，感叹号是非的意思</strong>。</p>
<p>针对邮编的正则可以改成 <code>(?&lt;!\d)\d{6}(?!\d)</code>。</p>
<p>表示单词边界的 <code>\b</code> 也可以用环视的方式来写。例如 <code>the little cat is in the hat</code>，单词可以用 <code>\w+</code> 来表示，单词的边界其实就是那些不能组成单词的字符，即左边和右边都不能是组成单词的字符。</p>
<p><code>(?&lt;!\w)</code> 表示左边不能是单词组成字符，<code>(?!\w)</code> 右边不能是单词组成字符，即 <code>\b\w+\b</code> 也可以写成 <code>(?&lt;!\w)\w+(?!\w)</code>。可以写成 <code>(?&lt;=\W)\w+(?=\W)</code>。</p>
<h2 id="转义">转义</h2>
<p>转义在工作中是比较常见的，如 <code>str = &quot;How do you spell the word \&quot;regex\&quot;?&quot;</code>，但是正则中什么时候需要转义，什么时候不用转义？</p>
<h3 id="转义字符">转义字符</h3>
<p>转义字符自身和后面的字符看成一个整体，用来表示某种含义。最常见的例子是，C 语言中用反斜线字符 <code>\</code> 作为转义字符，来表示那些不可打印的 ASCII 控制符。另外，在 URI 协议中，请求串中的一些符号有特殊含义，也需要转义，转义字符用的是百分号 <code>%</code>。</p>
<p>之所以称为转义字符，是因为它后面的字符，不是原来的意思了。例如文件名中有 <code>*</code> 号，我们就需要转义：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rm access_log*    <span class="c1"># 删除当前目录下 access_log 开头的文件</span>
</span></span><span class="line"><span class="cl">rm access_log<span class="se">\*</span>   <span class="c1"># 删除当前目录下名字叫 access_log* 的文件</span>
</span></span></code></pre></div><h3 id="字符串转义和正则转义">字符串转义和正则转义</h3>
<p>正则中也是使用 <code>\</code> 进行转义的。</p>
<p>一般来说，正则中 <code>\d</code> 代表的是单个数字，但如果我们想表示成 反斜杠和字母 d，这时候就需要进行转义，写成 <code>\\d</code>。</p>
<p>在程序中表示普通字符串的时候，我们如果要表示反斜杠，通常需要写成<strong>两个反斜杠</strong>，因为只写一个会被理解成“转义符号”，而不是反斜杠本身。</p>
<p>在程序使用过程中，从输入的字符串到正则表达式，其实有两步转换过程，分别是<strong>字符串转义</strong>和<strong>正则转义</strong>。</p>
<p>在正则中正确表示“反斜杠”具体的过程是这样子：我们输入的字符串，四个<code>\\\\</code>，经过第一步字符串转义，它代表的含义是两个 <code>\\</code>；这两个反斜杠再经过第二步正则转义，它就可以代表单个 <code>\</code> 了。</p>
<h3 id="元字符的转义">元字符的转义</h3>
<p>如果现在要查找比如<code>*</code>、<code>+</code>、<code>?</code> 本身，而不是元字符的功能，这时候就需要对其进行转义，直接在前面加上反斜杠就可以了。</p>
<p>正则中方括号 <code>[]</code> 和 花括号 <code>{}</code> 只需转义开括号，但圆括号 <code>()</code> 两个都要转义。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;\(\)\[]\</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;()[]</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;()[]</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;\(\)\[\]\{\}&#39;</span><span class="p">,</span> <span class="s1">&#39;()[]</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># 方括号和花括号都转义也可以</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;()[]</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">]</span>
</span></span></code></pre></div><p>在正则中，圆括号通常用于分组，或者将某个部分看成一个整体，如果只转义开括号或闭括号，正则会认为少了另外一半，所以会报错。</p>
<h4 id="字符组中的转义">字符组中的转义</h4>
<p>字符组中需要转义的有三种情况：</p>
<ol>
<li>脱字符在中括号中，且在第一个位置需要转义：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^ab]&#39;</span><span class="p">,</span> <span class="s1">&#39;^ab&#39;</span><span class="p">)</span>  <span class="c1"># 转义前代表&#34;非&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;^&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\^ab]&#39;</span><span class="p">,</span> <span class="s1">&#39;^ab&#39;</span><span class="p">)</span>  <span class="c1"># 转义后代表普通字符</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
</span></span></code></pre></div><ol start="2">
<li>中划线在中括号中，且不在首尾位置：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"> <span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[a-c]&#39;</span><span class="p">,</span> <span class="s1">&#39;abc-&#39;</span><span class="p">)</span>  <span class="c1"># 中划线在中间，代表&#34;范围&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[a\-c]&#39;</span><span class="p">,</span> <span class="s1">&#39;abc-&#39;</span><span class="p">)</span>  <span class="c1"># 中划线在中间，转义后的</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[-ac]&#39;</span><span class="p">,</span> <span class="s1">&#39;abc-&#39;</span><span class="p">)</span>  <span class="c1"># 在开头，不需要转义</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[ac-]&#39;</span><span class="p">,</span> <span class="s1">&#39;abc-&#39;</span><span class="p">)</span>  <span class="c1"># 在结尾，不需要转义</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span>
</span></span></code></pre></div><ol start="3">
<li>右括号在中括号中，且不在首位：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"> <span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[]ab]&#39;</span><span class="p">,</span> <span class="s1">&#39;]ab&#39;</span><span class="p">)</span>  <span class="c1"># 右括号不转义，在首位</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[a]b]&#39;</span><span class="p">,</span> <span class="s1">&#39;]ab&#39;</span><span class="p">)</span>  <span class="c1"># 右括号不转义，不在首位</span>
</span></span><span class="line"><span class="cl"> <span class="p">[]</span>  <span class="c1"># 匹配不上，因为含义是 a后面跟上b]</span>
</span></span><span class="line"><span class="cl"> <span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[a\]b]&#39;</span><span class="p">,</span> <span class="s1">&#39;]ab&#39;</span><span class="p">)</span>  <span class="c1"># 转义后代表普通字符</span>
</span></span><span class="line"><span class="cl"> <span class="p">[</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
</span></span></code></pre></div><h2 id="参考链接">参考链接</h2>
<ul>
<li><a href="https://time.geekbang.org/column/intro/100053301" target="_blank" rel="noopener noreffer">正则表达式入门课</a></li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2022-08-24&nbsp;<a class="git-hash" href="https://github.com/shipengqi/shipengqi.github.io/commit/aa588cd72b95ab35ec6e15637fb1e110281b2200" target="_blank" title="commit by shipengqi(pooky.shipengqi@gmail.com) aa588cd72b95ab35ec6e15637fb1e110281b2200: | display error">
                                    <i class="fas fa-hashtag fa-fw"></i>aa588cd</a></span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/posts/2020-05-20-regex/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/2020-11-03-oauth2-getting-started/" class="prev" rel="prev" title="OAuth 2.0 Getting Started"><i class="fas fa-angle-left fa-fw"></i>OAuth 2.0 Getting Started</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.119.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2017 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">shipengqi</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
